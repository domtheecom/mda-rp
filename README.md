# Miami-Dade Academy RP

Miami-Dade Academy RP is a serious, whitelisted FiveM environment that integrates a Miami ID system, Discord role syncing, a custom economy framework, and themed user interfaces built around the academy brand colors.

## Pre-Launch Ideas & Recommendations
- **Academy Handbook**: Publish a PDF or Google Doc with SOPs and link it in the loading screen tips array (`html/config.js`).
- **Orientation Experience**: Use the `/mdaweatheralert` command to broadcast academy briefings as players join the loading screen.
- **Recruitment Events**: Schedule weekly academy classes and promote them via the loading screen tip rotation and Discord `#academy-schedule` channel.
- **Role Audits**: Run `/mda_rolesync` after each large recruitment wave to keep payouts and HUD employment data aligned.

## Repository Structure
- `resources/mda_resources/` – custom scripts listed below.
- `docs/discord-setup.md` – Discord category, channel, and role configuration guide.
- `server.cfg` – sample configuration to load resources in the recommended order.

### Custom Resources Overview
| Resource | Purpose |
|----------|---------|
| `mda_loading` | Miami-themed loading screen that displays Miami ID, RP name, Discord info, and resource progress. |
| `mda_hud` | Static HUD with RP identity, EST military time, street/postal data, account balances, and weather alerts. |
| `mda_miami_id` | Miami ID verification, Discord deferrals, and registration command (`/mda_register`). |
| `mda_postals` | Dynamic Miami postal grid and custom street name overrides covering the entire map. |
| `mda_import_blips` | Framework for custom import MLO blips (placeholder list ready for expansion). |
| `mda_nametags` | Displays RP names above players using state synchronization with the Miami ID system. |
| `mda_rolesync` | Discord role synchronization for agencies, businesses, gangs, and civilian careers. |
| `mda_weather` | Admin-only weather control and broadcast alerts that display in the HUD. |
| `mda_payouts` | Automated 30-minute payouts based on Discord role groups with `/mdapayout` overrides. |
| `mda_keybinds` | Registers common academy keybinds (`togglehud`, panic, seatbelt, etc.). |
| `mda_framework` | Economy + status framework (health, hunger, thirst, stamina, stress) rendered below the minimap. |
| `mda_speedometer` | Miami-styled digital speedometer visible while in vehicles. |
| `mda_mlo_loader` | Placeholder loader for future MLO resources. |
| `mda_civ_careers` | Directory for custom civilian job scripts. |

## Installation
1. Copy the `resources/mda_resources` directory into your server `resources` folder.
2. Replace placeholders in `server.cfg` with your production keys:
   - `sv_licenseKey`
   - `steam_webApiKey`
   - `mda_discord_bot_token`
3. Update the MySQL connection string (or move credentials to environment variables) and run the SQL migrations generated by the scripts automatically (tables are created at runtime).
4. Edit `mda_rolesync/config.lua` to include the real Discord role IDs.
5. Provide the correct asset files for the loading screen (`logo.png`, `background.jpg`, `music.mp3`, etc.).
6. Add approved MLO resources to `resources/mda_resources/mda_mlo_loader` and register them with the provided event (`TriggerEvent('mda_mlo_loader:register', 'resourceName')`).

### Removing Conflicting Default Scripts
Disable the following default resources to avoid conflicts with the custom framework:
- `chat-theme-gtao` (replaced by branded HUD elements)
- `basic-gamemode` and any default `maps` that overlap with your MLOs
- Redundant `playernames` scripts if they interfere with `mda_nametags`
- Any economy or status mods (e.g., `esx_basicneeds`) that modify hunger/thirst to prevent double application

## Database Tables
The resources create tables on first run using `oxmysql`. Ensure the connected database user has permission to create tables:
- `mda_identities`
- `mda_accounts`

## Commands Summary
| Command | Description | Access |
|---------|-------------|--------|
| `/mda_register <discordId> <RP Name> [Employment] [Status]` | Register a Miami ID manually. | Console or `mda.admin` |
| `/mda_rolesync` | Force role synchronization for the caller or all players (console). | Console or `mda.admin` |
| `/mdaweather <type>` | Update the global weather (`clear`, `rain`, `storm`, etc.). | `mda.admin` |
| `/mdaweatheralert <message>` | Broadcast a weather/alert banner in the HUD. | `mda.admin` |
| `/mdapayout <group> <amount>` | Adjust payout per Discord role group. | `mda.admin` |
| `/mdapaynow` | Trigger immediate payouts. | `mda.admin` |
| `/togglehud` | Toggle the HUD visibility (bound to `F7`). | Everyone |

## Development Notes
- Use the placeholders in `mda_rolesync/config.lua` to map real Discord IDs.
- Add Sonoran CAD integrations (panic alerts, dispatch logs) via webhook endpoints listed in `docs/discord-setup.md`.
- Expand the loading screen tips array in `mda_loading/html/config.js` for academy reminders.
- Keep the brand palette consistent: `#2cab8e` (main), `#033933` (secondary), `#f7e9c3` (text).

## Testing Checklist
- Start the server and verify that deferrals enforce Discord + Miami ID registration.
- Confirm HUD updates: time, street/postal, employment, wallet.
- Run `/mdaweather` and observe the HUD alert banner.
- Trigger `/mdapaynow` and ensure payouts appear in chat and wallet increases.
- Join with Discord roles removed to confirm employment resets to `Unemployed`.

For full Discord setup instructions, read [`docs/discord-setup.md`](docs/discord-setup.md).
